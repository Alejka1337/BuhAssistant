# –§–æ—Ä–º–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Backend

## –î–∞—Ç–∞: 2025-11-15

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ü—Ä–æ–±–ª–µ–º–∞
- –§–æ—Ä–º–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Vercel + Resend
- –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å –∫–∞–∫ URI (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É), –∞ –Ω–µ —Å–∞–º —Ñ–∞–π–ª
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –†–µ—à–µ–Ω–∏–µ
–ü–µ—Ä–µ–¥–µ–ª–∞–ª–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –±–µ–∫–µ–Ω–¥:
1. Frontend —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ backend
2. Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º –∞—É–¥–∏–æ-—Ñ–∞–π–ª–æ–º

## –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend

1. **`backend/app/api/consultation.py`** (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
   - Endpoint `/api/consultation/submit` (POST)
   - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: `name`, `email`, `message`, `audio_file` (multipart/form-data)
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email –Ω–∞ `dmitrjialekseev16@gmail.com`
   - –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∞—É–¥–∏–æ-—Ñ–∞–π–ª –∫ –ø–∏—Å—å–º—É

2. **`backend/app/main.py`**
   - –î–æ–±–∞–≤–ª–µ–Ω —Ä–æ—É—Ç–µ—Ä –¥–ª—è consultation

### Frontend

3. **`constants/api.ts`**
   - –î–æ–±–∞–≤–ª–µ–Ω `CONSULTATION.SUBMIT` endpoint

4. **`components/ConsultationModal.tsx`**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç FormData –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ backend –≤–º–µ—Å—Ç–æ Vercel
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É
```
- –ò–º—è: –î–º–∏—Ç—Ä–∏–π
- Email: user@example.com
- –°–æ–æ–±—â–µ–Ω–∏–µ: –•–æ—á—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é
- [–ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è] üé§
```

### 2. Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ Backend
```typescript
FormData {
  name: "–î–º–∏—Ç—Ä–∏–π",
  email: "user@example.com",
  message: "–•–æ—á—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é",
  audio_file: [binary audio file]
}
```

### 3. Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Email
```
–û—Ç: dmitrjialekseev16@gmail.com
–ö–æ–º—É: dmitrjialekseev16@gmail.com
–¢–µ–º–∞: –ù–æ–≤–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é –≤—ñ–¥ –î–º–∏—Ç—Ä–∏–π

–ù–æ–≤–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é

–î–∞—Ç–∞ —Ç–∞ —á–∞—Å: 15.11.2024 14:30

–Ü–º'—è –∫–ª—ñ—î–Ω—Ç–∞: –î–º–∏—Ç—Ä–∏–π
Email –¥–ª—è –∑–≤'—è–∑–∫—É: user@example.com

–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:
–•–æ—á—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é

–ì–æ–ª–æ—Å–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ–¥–∞–Ω–æ —É –≤–∫–ª–∞–¥–µ–Ω–Ω—ñ.

–í–ª–æ–∂–µ–Ω–∏–µ: recording-XXXX.m4a
```

## API Endpoint

### POST /api/consultation/submit

**Content-Type:** `multipart/form-data`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `name` (string, required) - –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞
- `email` (string, required) - Email –∫–ª–∏–µ–Ω—Ç–∞
- `message` (string, optional) - –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `audio_file` (file, optional) - –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (m4a)

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "message": "–ó–∞—è–≤–∫–∞ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞"
}
```

**–û—Ç–≤–µ—Ç (–æ—à–∏–±–∫–∞):**
```json
{
  "detail": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend: cd backend && python -m uvicorn app.main:app --reload
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ frontend: npx expo start
3. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è" –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - –ò–º—è: –¢–µ—Å—Ç
   - Email: test@example.com
   - –°–æ–æ–±—â–µ–Ω–∏–µ: –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
6. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø–∏—à–∏—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
7. –ù–∞–∂–º–∏—Ç–µ "–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏"
8. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É dmitrjialekseev16@gmail.com
```

### –ß–µ—Ä–µ–∑ curl (–±–µ–∑ –∞—É–¥–∏–æ):
```bash
curl -X POST http://localhost:8000/api/consultation/submit \
  -F "name=–î–º–∏—Ç—Ä–∏–π" \
  -F "email=test@example.com" \
  -F "message=–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
```

### –ß–µ—Ä–µ–∑ curl (—Å –∞—É–¥–∏–æ):
```bash
curl -X POST http://localhost:8000/api/consultation/submit \
  -F "name=–î–º–∏—Ç—Ä–∏–π" \
  -F "email=test@example.com" \
  -F "message=–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" \
  -F "audio_file=@/path/to/audio.m4a"
```

## Email –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### SMTP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```python
SMTP_SERVER = "smtp.gmail.com"
SMTP_PORT = 587
EMAIL_ADDRESS = "dmitrjialekseev16@gmail.com"
EMAIL_PASSWORD = "maxrgkgeggjxysek"  # App password
ADMIN_EMAIL = "dmitrjialekseev16@gmail.com"
```

### –í–∞–∂–Ω–æ:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è App Password –æ—Ç Google (–Ω–µ –æ–±—ã—á–Ω—ã–π –ø–∞—Ä–æ–ª—å)
- –¢–æ—Ç –∂–µ –∞–∫–∫–∞—É–Ω—Ç —á—Ç–æ –∏ –¥–ª—è activation emails
- –ü–∏—Å—å–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –∏ –Ω–∞ –æ–¥–∏–Ω –∞–¥—Ä–µ—Å (–ø–æ–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤)

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

1. ‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:** –ù–µ –∑–∞–≤–∏—Å–∏–º –æ—Ç Vercel/Resend
2. ‚úÖ **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å:** –í–µ—Å—å –∫–æ–¥ –Ω–∞ –Ω–∞—à–µ–º backend
3. ‚úÖ **–§–∞–π–ª—ã —Ä–∞–±–æ—Ç–∞—é—Ç:** –ê—É–¥–∏–æ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –∫ –ø–∏—Å—å–º—É
4. ‚úÖ **–ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ email —Å–µ—Ä–≤–∏—Å —á—Ç–æ –∏ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
5. ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:** –ù–µ –Ω—É–∂–Ω—ã —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ API –∫–ª—é—á–∏

## UI —É–ª—É—á—à–µ–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–æ:
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –∞—É–¥–∏–æ
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å (–∫—Ä–µ—Å—Ç–∏–∫)
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (TODO)

- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏)
- [ ] –î–æ–±–∞–≤–∏—Ç—å CAPTCHA –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞
- [ ] –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–∞—è–≤–∫–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–∫–∏
- [ ] –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É –Ω–∞ –µ–≥–æ email
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∞—É–¥–∏–æ (mp3, wav)
- [ ] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ 10MB)

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### Backend:
```
INFO: "POST /api/consultation/submit HTTP/1.1" 200 OK
```

### Frontend:
```
–ê—É–¥–∏–æ —Ñ–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω –∫ –∑–∞–ø—Ä–æ—Å—É: recording-XXXX.m4a
```

## –ß—Ç–æ —É–¥–∞–ª–∏—Ç—å

–ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å Vercel (–µ—Å–ª–∏ –æ–Ω–∏ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã):
- `/api/sendEmail.ts` (–µ—Å–ª–∏ –±—ã–ª)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `resend` –≤ package.json (–µ—Å–ª–∏ –±—ã–ª–∏)

