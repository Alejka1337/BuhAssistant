Слушай я подумал зачем нам городить кучу разных обработок всевозможных вариантов записей в файле. Я могу вручуную подогнать все файлы под одинаковую структуру.


Так будет проще и быстрее.
Я сейчас говорю только про файл с большим перечнем реквизитов {областьОбщ.xlsx}. 


1) Первая Строка - всегда будет названия заголовков таблицы

- Найменування адміністративно-териториальної одиниці 	–(ячейка A1)
- Отримувач – (ячейка B1) 
- Код отримувача (ЄДРПОУ) – (ячейка C1)
- Банк отримувача – (ячейка D1)
- Номер рахунку (IBAN) – (ячейка E1)
- Код класифікації доходів бюджету – (ячейка F1)
- Найменування коду класифікації доходів бюджету – (ячейка G1)

Начиная со 2 строки и до конца файла будут строки таблицы с реквизитами.

Теперь описание по каждой

2) Что будет в колонке A2 и до конца колонки.

Тут будет название териториально громады. В разных файлах они могут называться по разному. Ниже примеры

- ВОЛИНСЬКА ОБЛАСТЬ
- Литовезька сільська ТГ
- Надвірнянська міська ТГ
- IВАНО-ФРАНКIВСЬКА ОБЛАСТЬ/ОБЛАСНИЙ
- Білокоровицька/с. Білокоровичі
- Миропільська/смт Миропіль
- IНГУЛЕЦЬКИЙ м. Кривий Ріг
- ГОЛОСІЇВСЬКИЙ

Короче как видишь варианты написания могут быть разные в разных файлах. 
Я предлагаю взять текст и его записывать в БД в поле district.
Как-то дополнительно его обрабатывать как будто-бы нету смысла и все варианты мы не сможем обработать.

3) Что будет в колонке B2 и до конца колонки.

Примеры что будет записанно 
- ГУК у Дн-кiй обл/Iнгул.р/11010500
- ГУК у Жит.обл/ТГ м.Андрушiвка/13040200
- ГУК в Iвано-Франківській області/ТГ Рожнятів/11011300
- ГУК у м.Києві/Святош.р-н/11024801


Варианты тоже разные, но нам в БД в поле recipient_name нужно записывать только 
"ГУК у Дніпропетровській області" 
или 
"ГУК у Житомирській області"
или 
"ГУК у м.Києві"

То есть можно где-то записать их как константы и подставлять прямо в recipient_name

4) Что будет в колонке C2 и до конца колонки.

Тут всегда будет код ЄДРПОУ

я вот не знаю будет ли он как строка или как число. Но это как правило 7-9 значный код. 
Например 37988155

Тут все просто мы его сразу и записываем в БД как recipient_code

5) Что будет в колонке D2 и до конца колонки.

Тут всегда будет строка 
"Казначейство України (ел. адм. подат.)"

Можем ее вынести как константу и записывать для всех в bank_name.

6) Что будет в колонке E2 и до конца колонки.

здесь всегда будет номер IBAN
что-то такое UA638999980333129340000026002

просто достаем и записываем в iban

7) Что будет в колонке F2 и до конца колонки.

Здесь будут коды классификации. Например 11010100.

Напоминаю нам нужны не все коды,а только определнные. 

Мы проходим по файлу xlsx сверяем значение F2 с теми кодами которые нам нужны. Если совпадает записываем в БД. Если не совпадает переходим к F3.

Код записываем в classification_code

8) Что будет в колонке G2 и до конца колонки.

Здесь будет описание. Если оно для нужного классификатора сохраняем его в description

