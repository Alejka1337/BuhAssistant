# Google –ü–∞—Ä—Å–∏–Ω–≥ - –ü—Ä–æ–±–ª–µ–º–∞ –∏ –†–µ—à–µ–Ω–∏—è

## ‚ö†Ô∏è –¢–µ–∫—É—â–∞—è –°–∏—Ç—É–∞—Ü–∏—è

**Google –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞.**

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –Ω–∞–ø—Ä—è–º—É—é –ø–∞—Ä—Å–∏—Ç—å HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã Google Search:
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–ª–∏ CAPTCHA
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ User-Agent
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ CAPTCHA/reCAPTCHA
- Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ IP

## üîß –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –í—Ä–µ–º–µ–Ω–Ω–æ–µ –†–µ—à–µ–Ω–∏–µ

–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç Search API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **mock –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.

**–§–ª–∞–≥:** `USE_MOCK = True` –≤ `backend/app/services/google_parser.py`

**Mock –¥–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç:**
- 3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è `tax.gov.ua`
- 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è `zakon.rada.gov.ua`
- 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è `buhgalter911.com.ua`

–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç:
- `title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ
- `url` - —Ä–µ–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—á–∞—è —Å—Å—ã–ª–∫–∞
- `source` - –¥–æ–º–µ–Ω –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- `date` - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## ‚úÖ Production –†–µ—à–µ–Ω–∏—è

### 1. Google Custom Search API (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è MVP)

**–ü–ª—é—Å—ã:**
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API –æ—Ç Google
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- 100 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å

**–ú–∏–Ω—É—Å—ã:**
- –ü–ª–∞—Ç–Ω—ã–π –ø–æ—Å–ª–µ 100 –∑–∞–ø—Ä–æ—Å–æ–≤ ($5 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**

1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –í–∫–ª—é—á–∏—Ç—å Custom Search API
3. –ü–æ–ª—É—á–∏—Ç—å API Key
4. –°–æ–∑–¥–∞—Ç—å [Custom Search Engine](https://programmablesearchengine.google.com/)
5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å "Search the entire web"

**–ö–æ–¥:**
```python
import requests

def search_google_api(query: str, domain: str, api_key: str, cx: str):
    url = "https://www.googleapis.com/customsearch/v1"
    params = {
        'key': api_key,
        'cx': cx,
        'q': f'site:{domain} {query}',
        'num': 3
    }
    
    response = requests.get(url, params=params)
    data = response.json()
    
    results = []
    for item in data.get('items', []):
        results.append({
            'title': item['title'],
            'description': item.get('snippet', ''),
            'url': item['link'],
            'source': domain,
            'date': None  # API –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞—Ç—É
        })
    
    return results
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–ª—è BuhAssistant:**
- 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π √ó 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü = 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤
- $5 √ó 10 = **$50/–º–µ—Å—è—Ü**

---

### 2. SerpAPI (–°–∞–º–æ–µ –ü—Ä–æ—Å—Ç–æ–µ –†–µ—à–µ–Ω–∏–µ)

**–ü–ª—é—Å—ã:**
- –ì–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
- –û–±—Ö–æ–¥ CAPTCHA
- Rotating proxies –≤–∫–ª—é—á–µ–Ω—ã
- –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ú–∏–Ω—É—Å—ã:**
- –ü–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å (~$50-200/–º–µ—Å—è—Ü)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ [SerpAPI](https://serpapi.com/)
2. –ü–æ–ª—É—á–∏—Ç—å API Key
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É: `pip install google-search-results`

**–ö–æ–¥:**
```python
from serpapi import GoogleSearch

def search_serpapi(query: str, domain: str, api_key: str):
    params = {
        'q': f'site:{domain} {query}',
        'api_key': api_key,
        'num': 3
    }
    
    search = GoogleSearch(params)
    results = search.get_dict()
    
    parsed_results = []
    for item in results.get('organic_results', []):
        parsed_results.append({
            'title': item.get('title', ''),
            'description': item.get('snippet', ''),
            'url': item.get('link', ''),
            'source': domain,
            'date': item.get('date', None)
        })
    
    return parsed_results
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å:**
- Free: 100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü
- Developer: $50/–º–µ—Å—è—Ü (5,000 –∑–∞–ø—Ä–æ—Å–æ–≤)
- Production: $125/–º–µ—Å—è—Ü (15,000 –∑–∞–ø—Ä–æ—Å–æ–≤)

---

### 3. ScraperAPI + Proxy Rotation

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø–∞—Ä—Å–∏–Ω–≥–æ–º
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥
- –û–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ —Ä–∞–±–æ—Ç—ã
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ
- –ù—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ [ScraperAPI](https://www.scraperapi.com/)
2. –ü–æ–ª—É—á–∏—Ç—å API Key

**–ö–æ–¥:**
```python
async def parse_google_with_scraperapi(query: str, domain: str, api_key: str):
    search_query = f"site:{domain} {query}"
    encoded_query = urllib.parse.quote(search_query)
    google_url = f"https://www.google.com/search?q={encoded_query}&num=10"
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º ScraperAPI –∫–∞–∫ proxy
    scraperapi_url = f"http://api.scraperapi.com?api_key={api_key}&url={google_url}"
    
    async with aiohttp.ClientSession() as session:
        async with session.get(scraperapi_url) as response:
            html = await response.text()
    
    # –î–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—à —Ç–µ–∫—É—â–∏–π –ø–∞—Ä—Å–∏–Ω–≥
    soup = BeautifulSoup(html, 'lxml')
    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –ø–∞—Ä—Å–∏–Ω–≥–∞
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å:**
- Free: 1,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü
- Hobby: $29/–º–µ—Å—è—Ü (10,000 –∑–∞–ø—Ä–æ—Å–æ–≤)
- Startup: $99/–º–µ—Å—è—Ü (100,000 –∑–∞–ø—Ä–æ—Å–æ–≤)

---

### 4. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –†–µ—à–µ–Ω–∏–µ (Advanced)

**–ò—Å–ø–æ–ª—å–∑—É—è Selenium/Playwright + Rotating Proxies**

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–µ—à–µ–≤–ª–µ –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ
- –ú–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ JavaScript-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–ú–∏–Ω—É—Å—ã:**
- –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (proxy pool)
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ
- –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. Selenium/Playwright –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π —ç–º—É–ª—è—Ü–∏–∏
2. Rotating residential proxies (Bright Data, Oxylabs)
3. CAPTCHA solving service (2captcha, Anti-Captcha)
4. User-Agent rotation
5. Cookie management

**–°—Ç–æ–∏–º–æ—Å—Ç—å:**
- Proxies: $75-500/–º–µ—Å—è—Ü
- CAPTCHA solving: $2-10/–º–µ—Å—è—Ü
- Infrastructure: $50-200/–º–µ—Å—è—Ü

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –†–µ—à–µ–Ω–∏–π

| –†–µ—à–µ–Ω–∏–µ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ç–æ–∏–º–æ—Å—Ç—å/–º–µ—Å | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –í—Ä–µ–º—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ |
|---------|-----------|---------------|------------|------------------|
| Google Custom Search API | –ù–∏–∑–∫–∞—è | $50 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 1-2 —á–∞—Å–∞ |
| SerpAPI | –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è | $50-200 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 30 –º–∏–Ω |
| ScraperAPI + –ü–∞—Ä—Å–∏–Ω–≥ | –°—Ä–µ–¥–Ω—è—è | $30-100 | ‚≠ê‚≠ê‚≠ê‚≠ê | 2-4 —á–∞—Å–∞ |
| –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ (Selenium+Proxy) | –í—ã—Å–æ–∫–∞—è | $100-700 | ‚≠ê‚≠ê‚≠ê | 1-2 –Ω–µ–¥–µ–ª–∏ |

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è BuhAssistant MVP

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SerpAPI –¥–ª—è MVP**, –ø–æ—Ç–æ–º—É —á—Ç–æ:

1. ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (30 –º–∏–Ω—É—Ç)
2. ‚úÖ –í—ã—Å–æ–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
3. ‚úÖ –í–∫–ª—é—á–∞–µ—Ç –¥–∞—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç—Ä–∞–Ω–∏—Ü
4. ‚úÖ 100 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
5. ‚úÖ –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Google Custom Search API –ø–æ–∑–∂–µ

**–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ MVP** –∏ –æ—Ü–µ–Ω–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏:
- –ï—Å–ª–∏ < 5,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü ‚Üí **Google Custom Search API** ($50/–º–µ—Å)
- –ï—Å–ª–∏ > 15,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü ‚Üí **ScraperAPI** –∏–ª–∏ **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å Mock –Ω–∞ Real API

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É:
```bash
pip install google-search-results
```

2. –î–æ–±–∞–≤–∏—Ç—å –≤ `.env`:
```env
SERPAPI_KEY=your_api_key_here
```

3. –û–±–Ω–æ–≤–∏—Ç—å `google_parser.py`:
```python
USE_MOCK = False  # –û—Ç–∫–ª—é—á–∏—Ç—å mock
```

4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `search_with_serpapi()`

5. –ó–∞–º–µ–Ω–∏—Ç—å –≤—ã–∑–æ–≤ –≤ `search_multiple_sources()`

## üìù TODO –¥–ª—è Production

- [ ] –í—ã–±—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è SerpAPI)
- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –ø–æ–ª—É—á–∏—Ç—å API Key
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ fallback
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis (—É–≤–µ–ª–∏—á–∏—Ç—å TTL –¥–æ 24 —á–∞—Å–æ–≤)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ–∫—É—â–∏–π mock –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å UI
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å WebView
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∑–∞–∫–∞–∑—á–∏–∫—É

–ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ API:
- –°—Ä–∞–≤–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ò–∑–º–µ—Ä–∏—Ç—å latency
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

