# BuhAssistant MVP Development Plan

## ✅ Етап 1: Доопрацювання існуючого функціоналу (ЗАВЕРШЕНО)

**Мета:** Завершити базові фічі, що вже частково реалізовані, зробити їх production-ready.

### Frontend:

- Доробити всі калькулятори (перевірити формули, валідацію, UI)
- Покращити AccountingCalendar: додати можливість завантаження JSON файлів динамічно, обробку помилок
- Інтегрувати всі калькулятори в екран Tools (`app/(tabs)/tools.tsx`)
- Перевірити форму ConsultationModal на коректність відправки
- Додати базову обробку помилок та loading states

### Тестування:

- Перевірити всі калькулятори з реальними даними
- Протестувати форму консультації (відправка email)
- Перевірити календар з різними місяцями

---

## Етап 2: Backend інфраструктура (Foundation)

**Мета:** Підняти базову backend інфраструктуру для подальшої розробки.

### Backend Setup:

- Створити FastAPI проект структуру (`/backend` папка)
- Налаштувати Docker Compose з сервісами:
  - PostgreSQL
  - Redis
  - Elasticsearch
  - FastAPI app
- Налаштувати SQLAlchemy + Alembic для міграцій
- Створити базові моделі БД (users, news, forum_threads, forum_posts)
- Налаштувати CORS для React Native
- Створити health check endpoints

### CI/CD:

- Налаштувати `.gitlab-ci.yml` для автодеплою на EC2
- Dockerfile для production
- Базовий deployment скрипт

### Тестування:

- Перевірити доступність всіх сервісів через Docker
- Протестувати підключення до БД
- Перевірити health endpoints

---

## ✅ Етап 3: Пошук (Search Feature) - ЧАСТКОВО ЗАВЕРШЕНО

**Мета:** Реалізувати пошук по авторитетних джерелах з можливістю фільтрації.

### Frontend: ✅ ЗАВЕРШЕНО

- ✅ Створити UI для пошуку в `app/(tabs)/search.tsx`
- ✅ Додати фільтри по джерелах (multi-select modal з чекбоксами)
- ✅ Створити SearchResultCard компонент для відображення результатів
- ✅ Реалізувати `utils/searchService.ts` з mock даними
- ✅ Додати loading states, error handling, placeholder
- ✅ Інтегрувати відкриття статей через Linking.openURL
- ⏳ Інтегрувати з Google Custom Search API або SerpAPI (наступний крок)

**Поточний стан:**
- Пошук працює з mock даними для тестування UI
- Логіка формування запросів `site:domain.com` реалізована
- UI повністю готовий для production
- Див. документацію: `docs/GOOGLE_SEARCH_INTEGRATION.md`

### Backend: ⏳ ВІДКЛАДЕНО

- ⏳ Створити endpoint `/api/search` для проксування запитів до пошукового API
- ⏳ Додати кешування результатів у Redis (TTL 1 година)
- ⏳ Логування пошукових запитів у БД для аналітики

### Тестування: ✅ ГОТОВО ДО ТЕСТУВАННЯ

- ✅ Перевірити пошук по кожному джерелу окремо (UI готовий)
- ✅ Протестувати фільтри (multi-select працює)
- ✅ Перевірити відкриття статей через браузер
- ✅ Перевірити роботу без інтернету (обробка помилок додана)

---

## Етап 4: Краулер новин (News Crawler System)

**Мета:** Реалізувати систему збору та аналізу новин з авторитетних джерел.

### Backend:

- Створити папку `/backend/crawlers` з окремими scrapers для кожного сайту:
  - `tax_gov_ua_crawler.py`
  - `zakon_rada_crawler.py`
  - `minfin_crawler.py`
  - `liga_net_crawler.py`
  - `buhgalter911_crawler.py`
- Налаштувати Celery + Redis для периодичних tasks
- Створити Celery task для запуску краулерів кожні 2-3 години
- Інтегрувати OpenAI API для аналізу аудиторії (NER + categorization)
- Створити endpoints:
  - `GET /api/news` - список новин з пагінацією
  - `GET /api/news/{id}` - деталі новини
- Налаштувати Elasticsearch індекси для новин
- Створити систему тегування (ФОП 1/2/3, юрособи, ЄСВ, ПДВ тощо)

### Frontend:

- Створити екран з новинами (Home або окремий таб)
- Відображення новин у форматі стрічки
- Фільтри за категоріями та датами
- Pull-to-refresh для оновлення
- Детальний перегляд новини у WebView

### Тестування:

- Запустити краулери вручну, перевірити збір даних
- Перевірити коректність категоризації через OpenAI
- Протестувати відображення новин у застосунку
- Перевірити фільтри та пагінацію

---

## Етап 5: Авторизація (Authentication)

**Мета:** Реалізувати систему реєстрації та авторизації з email+password та Google OAuth2.

### Backend:

- Налаштувати JWT authentication (access + refresh tokens)
- Створити endpoints:
  - `POST /api/auth/register` - реєстрація
  - `POST /api/auth/login` - логін
  - `POST /api/auth/refresh` - оновлення токена
  - `POST /api/auth/google` - Google OAuth2 callback
- Налаштувати Google OAuth2 (credentials, redirect URIs)
- Створити middleware для перевірки JWT токенів
- Додати email verification (опціонально для MVP)

### Frontend:

- Встановити необхідні пакети (expo-auth-session для OAuth2)
- Створити екрани:
  - Login screen
  - Register screen
- Налаштувати Google Sign In через expo-auth-session
- Створити Context/Store для зберігання auth state (можна використати Zustand)
- Зберігання токенів у SecureStore (expo-secure-store)
- Додати Protected Routes для авторизованих користувачів

### Тестування:

- Протестувати реєстрацію з email+password
- Перевірити логін
- Протестувати Google OAuth2 flow
- Перевірити refresh token механізм
- Протестувати logout

---

## Етап 6: Профіль та персоналізація (Profile & Personalization)

**Мета:** Створити особистий кабінет користувача з можливістю налаштування профілю.

### Backend:

- Розширити User модель полями:
  - `user_type` (ФОП/Юрособа/Бухгалтер/Фізособа)
  - `fop_group` (1/2/3)
  - `tax_system` (для юросіб)
  - `notification_preferences` (JSON)
- Створити endpoints:
  - `GET /api/profile` - отримання профілю
  - `PUT /api/profile` - оновлення профілю
  - `GET /api/profile/stats` - статистика (кількість консультацій тощо)

### Frontend:

- Створити екран профілю в `app/(tabs)/profile.tsx` або окремий стек
- Форма редагування профілю
- Відображення статистики користувача
- Налаштування сповіщень
- Logout кнопка

### Тестування:

- Протестувати створення/оновлення профілю
- Перевірити збереження налаштувань
- Перевірити відображення персоналізованого контенту

---

## Етап 7: Push-уведомлення (Push Notifications)

**Мета:** Реалізувати систему персоналізованих push-уведомлень на основі новин та календаря.

### Backend:

- Налаштувати Expo Push Notifications сервіс
- Створити таблицю `push_tokens` для зберігання токенів користувачів
- Створити Celery tasks:
  - Відправка push на основі нових новин (з перевіркою аудиторії)
  - Відправка нагадувань про дедлайни з календаря (за 7, 3, 1 день)
- Створити endpoints:
  - `POST /api/notifications/register-token` - реєстрація push token
  - `GET /api/notifications/history` - історія сповіщень
- Інтегрувати логіку категоризації з OpenAI з етапу краулера

### Frontend:

- Налаштувати expo-notifications
- Запит дозволів на сповіщення
- Реєстрація push token на сервері
- Обробка отриманих сповіщень (foreground/background)
- Екран історії сповіщень

### Тестування:

- Протестувати отримання дозволів
- Відправити тестові push-уведомлення
- Перевірити таргетинг (push тільки для потрібної аудиторії)
- Протестувати нагадування про дедлайни

---

## Етап 8: Форум (Community Forum)

**Мета:** Створити форум для спілкування користувачів, обміну досвідом та порадами.

### Backend:

- Створити моделі БД:
  - `forum_categories` (ФОП 1/2/3, ПДВ, Зарплата тощо)
  - `forum_threads` (топіки)
  - `forum_posts` (повідомлення)
  - `forum_likes` (лайки)
- Створити endpoints:
  - `GET /api/forum/categories` - список категорій
  - `GET /api/forum/threads` - список топіків з фільтрами
  - `POST /api/forum/threads` - створення топіку
  - `GET /api/forum/threads/{id}` - деталі топіку + коментарі
  - `POST /api/forum/posts` - створення коментаря
  - `POST /api/forum/likes` - лайк/дизлайк
  - `PUT /api/forum/posts/{id}/best-answer` - відмітка найкращої відповіді
- Налаштувати Elasticsearch індекси для пошуку по форуму
- Базова модерація (можливість видалення власних постів)

### Frontend:

- Створити таб/екран форуму
- Список категорій
- Список топіків з фільтрами (нові, гарячі, без відповіді)
- Екран створення топіку
- Екран перегляду топіку з коментарями (вкладені до 3 рівнів)
- Можливість лайкати та коментувати
- Пошук по форуму

### Тестування:

- Створити кілька тестових категорій та топіків
- Протестувати створення топіку та коментування
- Перевірити лайки
- Протестувати пошук
- Перевірити вкладені коментарі

---

## Етап 9: Фінальна інтеграція та поліпшення

**Мета:** Зв'язати всі частини разом, додати поліпшення UX, оптимізувати продуктивність.

### Інтеграція:

- Персоналізація новин на основі профілю користувача
- Фільтрація календарних подій за типом користувача
- Інтеграція пошуку з форумом (пошук по всіх розділах)
- Додати аналітику подій (amplitude/mixpanel або власне рішення)

### Поліпшення:

- Додати offline mode де це можливо (календар, калькулятори)
- Оптимізувати завантаження списків (infinite scroll, pagination)
- Додати skeleton loaders
- Покращити error handling та user feedback
- Додати onboarding для нових користувачів

### Тестування:

- E2E тестування основних user flows
- Тестування на різних пристроях (iOS/Android)
- Performance testing (навантаження на backend)
- Security audit (основні вразливості)

---

## Етап 10: Підготовка до релізу

**Мета:** Підготувати застосунок до публікації в App Store та Google Play.

### Mobile App:

- Налаштувати production builds (EAS Build)
- Додати splash screen та іконки
- Налаштувати deep linking
- Оптимізація розміру bundle
- Додати privacy policy та terms of service

### Backend:

- Налаштувати production environment на EC2
- Налаштувати моніторинг (Sentry для помилок)
- Налаштувати логування (CloudWatch або ELK)
- Backup стратегія для БД
- Rate limiting для API endpoints
- SSL certificates (Let's Encrypt)

### Документація:

- API документація (FastAPI Swagger/ReDoc)
- README з інструкціями для deployment
- Документація для майбутньої команди

### Тестування:

- Фінальне manual testing всіх фіч
- Beta testing з реальними користувачами
- Збір feedback та виправлення критичних багів

